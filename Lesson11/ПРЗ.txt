Исходные данные:

Залы (ID_зала, Название, Этаж, Площадь)
Сотрудники (ID_сотрудника, ФИО, Дата_рождения, ID_должности, Телефон, Оклад)
Должности (ID_должности, Наименование)
Экспонаты (ID_экспоната, Название, Дата_поступления, Происхождение, ID_зала, ID_выставки, ID_сотрудника)
Групповые экскурсии (ID_экскурсии, Дата проведения, ID_сотрудника, Количество_человек, ID_выставки, ID_чека (он один на группу))
Выставки (ID_выставки, Название, Дата_начала, Дата_окончания)
Касса (ID_чека, Дата_продажи, Cумма)

Найти:
/*1. Вывести данные о выручке от экскурсий в зависимости от должности экскурсовода и месяца экскурсии. Результаты вывести в виде транспорнированной таблицы. (оси - должность и месяц)*/

SELECT Должность, [1], [2], [3], ... , [12]
FROM
	(SELECT   Empl.ID_должности AS Должность
		 ,MONTH(Дата Проведения) AS Month_exc
 	         ,(SELECT SUM(Cумма) OVER() FROM Касса) AS Revenue_exc
	FROM Групповые экскурсии AS Exc
	INNER JOIN (SELECT ID_должности
	    	    FROM Сотрудники) AS Empl ON Exc.ID_сотрудника = Empl.ID_сотрудника
	GROUP BY Должность, MONTH(Дата Проведения)
	ORDER BY MONTH(Дата Проведения) ASC
	) AS SourceTable
PIVOT 
	( 
	     SUM(Cумма)
             FOR Revenue_exc IN ([1],[2],...,[12])
	)AS PivotTable

2. Вывести ФИО сотрудников, ответственных за экспонаты выставки под названием "Лица эпохи", которые хранились на втором этаже.

SELECT empl.ФИО
FROM Сотрудники empl
INNER JOIN Экспонаты exh ON empl.ID_сотрудника = exh.ID_сотрудника
WHERE exh.Название = 'Лица эпохи' AND exh.ID_зала = (SELECT ID_зала
						     FROM Залы
						     WHERE Этаж = '2');
